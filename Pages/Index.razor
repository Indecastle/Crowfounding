@page "/"
@page "/Main"
@page "/Index"
@inject ApplicationDbContext _db;
@inject AuthenticationStateProvider AuthenticationStateProvider;
@inject UserManager<User> _userManager;
@inject NavigationManager NavigationManager
@inject IStringLocalizer<Index> L

<h3 class="text-center">@L["Most_Rating_Companies"]</h3>
<br />
<body>
    @if (Model?.ToList().Count > 0)
    {
        <div class="row">

            @foreach (var company in Model.OrderByDescending(s => s.Rating))
            {
                <div class="col-sm-6 col-md-4 my-grid">
                    <div class="img-thumbnail text-center">
                        <div class="grid-div-image"><img src="@company.MainImage" class="grid-image" /></div>
                        <div class="caption">
                            <h3>@L["Name"]: @company.Name</h3>
                            <h4>@L["Theme"]: @company.Theme</h4>
                            <h5>@L["Rating"]: @company.Rating</h5>
                            <p><NavLink class="btn btn-primary" href="@("CompanyView/"+company.Id)">@L["Open"]</NavLink></p>
                        </div>
                    </div>
                </div>
            }

        </div>
    }
    else
    {
        <h3>@L["No_company"]</h3>
    }

</body>

@code {
    public IEnumerable<Company> Model { get; set; }



    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        Model = await _db.Companies.ToListAsync();
    }

    public void Dispose()
    {
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {

        }
    }

    public void RedirectToCompany(Company company)
    {
        NavigationManager.NavigateTo("/" + company.Name);
    }
}